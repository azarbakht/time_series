---
title: 'ST565: Time Series HW7'
author: "Amirhosein \"Emerson\" Azarbakht <azarbaka@oregonstate.edu>"
output: pdf_document
layout: one-col

---

## Question 1

$$ \gamma(k) = \begin{cases}
\beta_1^2 \sigma^2 + \sigma^2 \text{\qquad for k = 0} \\
\beta_1 \sigma^2 \text{\qquad  for k = 1}\\
0 \text{\qquad for k >= 1}
\end{cases}
$$

$$ 
f(\omega) = 1/\pi \big[\gamma(0) + 2 \Sigma_{k=1}^\infty \gamma(k) \cos(\gamma k) \big]
$$

$$ 
f(\omega) = 1/\pi \big[\beta_1^2 \sigma^2 + \sigma^2 + 2 [\beta_1 \sigma^2] \cos(\gamma) \big]
$$

$$ 
f(\omega) = 1/\pi \big[\beta_1^2 \sigma^2 + \sigma^2 + 2 \beta_1 \sigma^2 \cos(\gamma) \big]
$$

$$ 
f(\omega) = \sigma^2/\pi \big[\beta_1^2 + 1 + 2 \beta_1 \cos(\gamma) \big]
$$

```{r}

# WN
# set.seed(1)
# x <- w <- rnorm(1024)
# for (t in 2:1024) x[t]<- w[t]
# layout(1:3)
# plot(as.ts(x))
# acf(x)
# spectrum(x, span = 51, log = c("no"))
# 
# # AR(1)
# set.seed(1)
# x <- w <- rnorm(1024)
# for (t in 2:1024) x[t]<- 0.9 * x[t-1] + w[t]
# layout(1:3)
# plot(as.ts(x))
# acf(x)
# spectrum(x, span = 51, log = c("no"))

# MA(1)
set.seed(1)
x <- w <- rnorm(1024)
# beta = 0.9
for (t in 2:1024) x[t]<- 0.9 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))

# beta = 0.7
for (t in 2:1024) x[t]<- 0.7 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))

# beta = 0.5
for (t in 2:1024) x[t]<- 0.5 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))

# beta = 0.3
for (t in 2:1024) x[t]<- 0.3 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))

# beta = 1
for (t in 2:1024) x[t]<- 1 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))

# beta = 3
for (t in 2:1024) x[t]<- 3 * w[t-1] + w[t]
layout(1:3)
plot(as.ts(x))
acf(x)
spectrum(x, span = 51, log = c("no"))





```

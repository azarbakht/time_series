load(url("http://stat565.cwick.co.nz/data/sales.rda"))
View(sales)
Maine.month <- read.table("http://staff.elena.aut.ac.nz/Paul-Cowpertwait/ts/Maine.dat", header = TRUE)
# header TRUE means treat first row as column names
attach(Maine.month)
str(Maine.month)
head(Maine.month)
class(Maine.month)
# it's a data.frame, not a ts object. So, we need to convert it to ts
Maine.month.ts <- ts(unemploy, start = c(1996, 1), freq = 12)
Maine.month.ts
Maine.annual.ts <- aggregate(Maine.month.ts)/12
Maine.month.ts
head(Maine.month)
Maine.annual.ts
plot(Maine.annual.ts)
plot(Maine.month.ts)
class(sales)
sales.ts <- ts(sales)
sales
plot(sales)
class(Maine.month)
head(Maine.month)
sales.ts <- ts(sales, start = (1992, 1), frequency = 12)
sales.ts <- ts(sales, start = c(1992, 1), frequency = 12)
sales
plot(sales)
plot(sales)
plot(sales.ts)
sales.ts
sales.ts
head(sales.ts)
head(sales)
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
sales.annual.ts <- aggregate(sales.month.ts)/12
head(sales.annual.ts)
plot(sales.annual.ts)
plot(sales.month.ts)
layout(1,2)
plot(sales.month.ts)
plot(sales.annual.ts)
head(sales)
library(dplyr)
sales <- sales %>% select(sales, value)
sales <- sales %>% select(value, sales)
sales <- sales %>% select(value)
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
sales.annual.ts <- aggregate(sales.month.ts)/12
head(sales.annual.ts)
plot(sales.annual.ts)
layout(1,2)
plot(sales.month.ts)
plot(sales.annual.ts)
layout(1,2)
plot(sales.month.ts)
plot(sales.annual.ts)
layout(1:2)
plot(sales.month.ts)
plot(sales.annual.ts)
plot(sales.month.ts, xy.labels = ("x","y"))
plot(sales.2005to2010)
sales.2005to2010 <- window(GlobalTemperatures.ts, start=c(1970, 1), end=c(2005, 12))
sales.2005to2010 <- window(sales.month.ts, start=c(2005, 1), end=c(2010, 12))
plot(sales.2005to2010)
?plot
plot(sales.month.ts, ylab = "yy")
plot(sales.month.ts, ylab = "monthly sales in millions of dollars")
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)")
plot(sales.annual.ts)
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)")
plot(sales.annual.ts)
?plot
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total monthly sales for motor vehicle & parts dealers in the USA from 1992 to 2014")
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total monthly sales for motor vehicle & parts dealers in the USA (1992-2014)")
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total monthly sales for motor vehicle & parts dealers in the USA (1992-2014)")
plot(sales.annual.ts)
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total monthly sales for motor vehicle & parts dealers in the USA (1992-2014)")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual sales for motor vehicle & parts dealers in the USA (1992-2014)")
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")+ scale_x_discrete()
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales") + scale_x_discrete()
qplot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales") + scale_x_discrete()
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
sales.2005to2010 <- window(sales.month.ts, start=c(2005, 1), end=c(2010, 12))
plot(sales.2005to2010, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2010, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2010, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2010, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2010, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2010")
# Convert to a Time Series object
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
# create an annual aggregate object
sales.annual.ts <- aggregate(sales.month.ts)/12
head(sales.annual.ts)
plot(sales.annual.ts)
layout(1:2)
axis(at = 1992:2014)
plot(sales.annual.ts)
axis(at = 1992:2014)
axis(side = 1, at = 1992:2014)
axis(side = 1, at = 1992:2014:1)
axis(side = 1, at = 1992:2014:3)
axis(side = 1, at = 1991:2015)
axis(side = 1, at = 1992)
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2009, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(sales.annual.ts)
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2008, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2006, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
tail(sales)
load(url("http://stat565.cwick.co.nz/data/sales.rda"))
class(sales)
head(sales)
tail(sales)
# import data
load(url("http://stat565.cwick.co.nz/data/sales.rda"))
class(sales)
head(sales)
tail(sales)
sales <- sales %>% select(value)
# Convert to a Time Series object
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
# create an annual aggregate object
sales.annual.ts <- aggregate(sales.month.ts)/12
head(sales.annual.ts)
plot(sales.annual.ts)
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
# explore the dip, zoom in to see better resolution
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(window(sales.month.ts, start=c(2006, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2008, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
sales.1992to2007 <- ts(sales, start = c(1992, 1), end=c(2007, 12), frequency = 12)
sales.2008 <- ts(sales, start = c(2008, 1), end=c(2008, 12), frequency = 12)
sales.2009to2013 <- ts(sales, start = c(2009, 1), end=c(2013, 12), frequency = 12)
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
sales.2006 <- ts(sales, start = c(2006, 1), end=c(2006, 12), frequency = 12)
sales.2008 <- ts(sales, start = c(2008, 1), end=c(2008, 12), frequency = 12)
sales.2008 <- ts(sales, start = c(2008, 1), end=c(2008, 12), frequency = 12)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(1:2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
# explore the dip, zoom in to see better resolution
sales.2006 <- ts(sales, start = c(2006, 1), end=c(2006, 12), frequency = 12)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
sales.2006
sales.2008
class(sales)
head(sales)
tail(sales)
sales.1992to2007 <- window(sales.month.ts, start=c(1992, 1), end=c(2007, 12))
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
sales.2008 <- window(sales.month.ts, start=c(2008, 1), end=c(2008, 12))
sales.2009to2013 <- window(sales.month.ts, start=c(2009, 1), end=c(2013, 12))
sales.2006 <- window(sales.month.ts, start=c(2005, 1), end=c(2012, 12))
sales.2006 <- window(sales.month.ts, start=c(2006, 1), end=c(2006, 12))
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
layout(1:2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
axis(side =1, at = 1:12)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
axis(side =1, at = 1:12)
?axis
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
axis(side =1, 1:12, c("Jan", "Feb")
)
axis(side =1, c("Jan", "Feb"))
?Date
months
months
months.Date()
axis(side =1, 1:12, c("Jan", "Feb", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"))
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
axis(side =1, 1:12, c("Jan", "Feb", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"))
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(2:1)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(2:2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(2:2)
layout(1:1)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(2)
?layout(2)
?layout(1,2)
layout(1,2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
layout(1,2:1)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
par(mfrow = c(1, 2))
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
par(mfrow = c(1, 2))
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006")
par(new=TRUE)
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", colors = "green")
par(new=TRUE)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", color = "green")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "green")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "green")
par(new=TRUE)
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
par(new=TRUE)
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
layout(1:1)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
par(new=TRUE)
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
sales.2006
sales.2008
sales.1992to2007 <- window(sales.month.ts, start=c(1992, 1), end=c(2007, 12))
sales.2008 <- window(sales.month.ts, start=c(2008, 1), end=c(2008, 12))
sales.2009to2013 <- window(sales.month.ts, start=c(2009, 1), end=c(2013, 12))
sales.2006 <- window(sales.month.ts, start=c(2006, 1), end=c(2006, 12))
sales.2006
sales.2008
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
sales.2008
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
layout(1:1)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
par(new=TRUE)
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
layout(1:2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "mult")
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "add"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "add"))
plot(decompose(sales.month.ts, type = "mult"))
plot(decompose(sales.month.ts))
plot(decompose(sales.month.ts, type = "add"))
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "add")
Trend <- sales.month.ts.decomposed$trend
Seasonal <- sales.month.ts.decomposed$seasonal
ts.plot(cbind(Trend, Trend * Seasonal), lty = 1:2)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "ss")
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality")
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality", ylab = "Monthly Sales (millions Dollars)")
layout(1:1)
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "add")
Trend <- sales.month.ts.decomposed$trend
Seasonal <- sales.month.ts.decomposed$seasonal
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality", ylab = "Monthly Sales (Million Dollars)")
sales.month.ts.decomposed
str(sales.month.ts.decomposed)
plot(sales.month.ts.decomposed$random)
Noise <- sales.month.ts.decomposed$random
library(plyr)
library(lubridate)
library(ggplot2)
options(stringsAsFactors = FALSE)
# import data
load(url("http://stat565.cwick.co.nz/data/sales.rda"))
class(sales)
head(sales)
tail(sales)
sales <- sales %>% select(value)
# Convert to a Time Series object
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
# create an annual aggregate object
sales <- sales %>% select(sales$value)
sales <- sales %>% select(sales$value)
sales <- sales %>% select(value)
sales <- sales$value
# Convert to a Time Series object
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
head(sales.month.ts)
plot(sales.month.ts)
# create an annual aggregate object
sales.annual.ts <- aggregate(sales.month.ts)/12
head(sales.annual.ts)
plot(sales.annual.ts)
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (millions Dollars)", main = "Total Annual Sales")
# explore the dip, zoom in to see better resolution
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(window(sales.month.ts, start=c(2006, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2008, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
sales.1992to2007 <- window(sales.month.ts, start=c(1992, 1), end=c(2007, 12))
sales.2008 <- window(sales.month.ts, start=c(2008, 1), end=c(2008, 12))
sales.2009to2013 <- window(sales.month.ts, start=c(2009, 1), end=c(2013, 12))
sales.2006 <- window(sales.month.ts, start=c(2006, 1), end=c(2006, 12))
sales.2006
sales.2008
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
layout(1:2)
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
```
## Decomposition
```{r}
plot(decompose(sales.month.ts))
# plot(decompose(sales.month.ts, type = "add"))
# plot(decompose(sales.month.ts, type = "mult"))
layout(1:1)
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "add")
Trend <- sales.month.ts.decomposed$trend
Seasonal <- sales.month.ts.decomposed$seasonal
Noise <- sales.month.ts.decomposed$random
sales.month.ts.decomposed
str(sales.month.ts.decomposed)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality", ylab = "Monthly Sales (Million Dollars)")
```
In summary,
*  The greatest source of variation in daily temperatures in Corvallis is the annual pattern, warm temperatures in the summer, cool in the winter.
*  There doesn't appear to be a systematic trend in the temperatures, although 2008 & 2009 appeared to be cooler than average
*  The serial correlation of daily temperatures (beyond the seasonal norms and trend) is high but falls rapidly and is negligible on a time scale of two weeks.
*  The variation in temperature is higher during the winter but shows no long term changes.
layout(1:1)
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "add")
Trend <- sales.month.ts.decomposed$trend
Seasonal <- sales.month.ts.decomposed$seasonal
Noise <- sales.month.ts.decomposed$random
str(sales.month.ts.decomposed)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality", ylab = "Monthly Sales (Million Dollars)")
```
acf(Noise)
Noise <- sales.month.ts.decomposed$random
Noise
act
?acf
acf(Noise, na.action = na.pass)$ac
acf(Noise, na.action = na.pass)
act(Noise, na.action = na.fail)
acf(Noise, na.action = na.fail)
acf(Noise, na.action = na.pass)$acf[2]
acf(Noise, na.action = na.pass)$acf[1]
acf(Noise, na.action = na.pass)$acf[2]
acf(Noise, na.action = na.pass)$acf[1:10]
range(Noise)
length(Noise)
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)])
acf(Noise,type = c("covariance"), na.action = na.pass)
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
# scatterplot of each autocorrelation for lag 1
# length(Noise)
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)])
acf(Noise, na.action = na.pass)
acf(Noise, na.action = na.pass, main = "Correlogram of Residual Noise")
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Time 1...t-1", ylab = "Time 2...t")
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Noise values at times 1...t-1", ylab = "Noise values at times 2...t")
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Noise values at times 1...t-1", ylab = "Noise values at times 2...t", main = "Scatterplot of each autocorrelation for lag 1 to investigate correlation")
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Noise values at times 1...t-1", ylab = "Noise values at times 2...t", main = "Scatterplot of each autocorrelation for lag 1 to check for correlation")
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Noise values at times 1...t-1", ylab = "Noise values at times 2...t", main = "Scatterplot of each autocorrelation for lag 1 to check for correlations")
# get autocovariances
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
# length(Noise)
plot(Noise[1:length(Noise)-1], Noise[2:length(Noise)], xlab = "Noise values at times 1...t-1", ylab = "Noise values at times 2...t", main = "Scatterplot of each autocorrelation for lag 1 to check for correlations")
# get autocovariances
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
# correlogram
acf(Noise, na.action = na.pass, main = "Correlogram of Residual Noise")
plot(decompose(Noise))
plot(Noise^2)
plot(decompose(Noise^2))
plot(decompose(Noise))
plot(Noise^2)
plot(decompose(Noise))
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[1]
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
acf(Noise, na.action = na.pass, , lag.max = 100, main = "Correlogram of Residual Noise")
acf(Noise,type = c("correlation"), na.action = na.pass)$acf[2]
covariance
acf(Noise,type = c("covariance"), na.action = na.pass)$acf[2]
acf(Noise, na.action = na.pass, , lag.max = 100, main = "Correlogram of Residual Noise")
load(url("http://stat565.cwick.co.nz/data/sales.rda"))
sales <- sales$value
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
plot(sales.month.ts)
sales.month.ts <- ts(sales, start = c(1992, 1), frequency = 12)
# head(sales.month.ts)
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", main = "Total Monthly Sales")
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", xlab = "Year", main = "Total Monthly Sales")
# create an annual aggregate object
sales.annual.ts <- aggregate(sales.month.ts)/12
layout(1:2)
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", xlab = "Year", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (Million Dollars)", xlab = "Year", main = "Total Annual Sales")
layout(1:1)
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", xlab = "Year", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (Million Dollars)", xlab = "Year", main = "Total Annual Sales")
plot(window(sales.month.ts, start=c(2005, 1), end=c(2012, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2005-2012")
plot(window(sales.month.ts, start=c(2006, 1), end=c(2011, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
plot(window(sales.month.ts, start=c(2007, 1), end=c(2008, 12)), ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2007-2011")
sales.1992to2007 <- window(sales.month.ts, start=c(1992, 1), end=c(2007, 12))
sales.2008 <- window(sales.month.ts, start=c(2008, 1), end=c(2008, 12))
sales.2009to2013 <- window(sales.month.ts, start=c(2009, 1), end=c(2013, 12))
sales.2006 <- window(sales.month.ts, start=c(2006, 1), end=c(2006, 12))
sales.2006
sales.2008
plot(sales.1992to2007, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 1992-2007")
plot(sales.2009to2013, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2009-2014")
plot(sales.2006, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2006", col = "blue")
plot(sales.2008, ylab = "Monthly Sales (millions Dollars)", main = "Total Monthly Sales for 2008", col = "red")
layout(1:1)
sales.month.ts.decomposed <- decompose(sales.month.ts, type = "add")
Trend <- sales.month.ts.decomposed$trend
Seasonal <- sales.month.ts.decomposed$seasonal
Noise <- sales.month.ts.decomposed$random
str(sales.month.ts.decomposed)
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2, main = "Superimposed Trend + Seasonality", ylab = "Monthly Sales (Million Dollars)")
plot(decompose(Noise))
plot(Noise^2)
# let's decompose the noise to see if there's any trends
plot(decompose(Noise))
acf(Noise, na.action = na.pass, , lag.max = 100, main = "Correlogram of Residual Noise")
acf(Noise, na.action = na.pass, lag.max = 100, main = "Correlogram of Residual Noise")
plot(decompose(Noise))
plot(Noise.decomposed, main = "Decomposed Residual Noise")
Noise.decomposed <- decompose(Noise)
plot(Noise.decomposed, main = "Decomposed Residual Noise")
plot(Noise.decomposed)
plot(Noise.decomposed$trend)
plot(Noise.decomposed$trend, main = "xd")
warning = FALSE, results = "show", fig.height = 3, fig.width = 6)
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", xlab = "Year", main = "Total Monthly Sales")
plot(sales.annual.ts, ylab = "Annual Sales (Million Dollars)", xlab = "Year", main = "Total Annual Sales")
plot(sales.month.ts, ylab = "Monthly Sales (Million Dollars)", xlab = "Year", main = "Total Monthly Sales")
